var e=Object.defineProperty,t=(t,s,i)=>((t,s,i)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i)(t,"symbol"!=typeof s?s+"":s,i);import{r as s,u as i,j as o,E as a,d as n,m as r,b as c,s as l}from"./index-sT5wyuMN.js";import{p as h}from"./phaser-BsKGbp7r.js";import{P as d}from"./popup-BNETPUH7.js";import{e as m,b as u,T as g}from"./game-CxZlzPMw.js";import"./with-default-props-YTkVgPz6.js";import"./get-scroll-parent-CbYlqSdh.js";class p extends h.Scene{constructor(){super("Boot")}preload(){this.load.setPath("assets/games/emoji-match/"),this.load.image("dark","bg.png")}create(){this.scene.start("Preloader")}}const f=new h.Events.EventEmitter;class v extends h.Scene{constructor(){super("GameOver"),t(this,"camera"),t(this,"background"),t(this,"gameOverText"),t(this,"scoreText"),t(this,"totalScore",0)}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;let i=this.add.image(t/2,s/2,"background");this.tweens.add({targets:i,alpha:{from:0,to:1},duration:1e3});const o={fontFamily:"Arial",fontSize:32,color:"#ffffff",fontStyle:"bold",padding:16,shadow:{color:"#000000",fill:!0,offsetX:2,offsetY:2,blur:4}},a=this.add.text(t/2,0,"Game Over",{fontFamily:"Arial Black",fontSize:50,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5,.5).setDepth(100);this.tweens.add({targets:a,y:s/2,ease:"bounce.out"});const n=this.add.text(t/2,s/2-200,`Found: ${this.registry.get("found")?this.registry.get("found"):0}`,o).setOrigin(.5,.5);this.tweens.add({targets:n,alpha:{from:0,to:1},scale:{from:.5,to:1},duration:1e3}),this.totalScore=this.registry.get("totalScore");const r=localStorage.getItem("maxFound")||0;this.registry.get("found")&&this.registry.get("found")>r&&localStorage.setItem("maxFound",this.registry.get("found")),this.scoreText=this.add.text(t/2,s/2-150,`Score: ${this.registry.get("totalScore")?this.registry.get("totalScore"):0}`,o).setOrigin(.5,.5),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")})),f.emit("current-scene-ready",this)}changeScene(){this.scene.start("MainMenu")}update(){var e,t;this.registry.get("found")&&(this.totalScore=this.totalScore+2,this.totalScore-this.registry.get("totalScore")>600*this.registry.get("found")?null==(e=this.scoreText)||e.setText("Score:"+(this.registry.get("totalScore")-600*this.registry.get("found"))):null==(t=this.scoreText)||t.setText(`Score:${this.totalScore}`))}}class x extends h.Scene{constructor(){super("Preloader"),t(this,"loadText")}init(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;this.add.image(t/2,s/2,"dark").setScale(t/540,s/839);const i=Math.max(t/2,280);this.add.rectangle(t/2,s/2,i,19).setStrokeStyle(1,16777215);const o=this.add.rectangle(t/2-i/2+5,s/2,4,14,16777215);this.loadText=this.add.text(t/2,s/2-40,"0%",{fontFamily:"Arial",fontSize:24,color:"#e3f2ed"}).setOrigin(.5,.5),this.load.on("progress",(e=>{o.width=i*e-5,this.loadText.setText(`${Math.floor(100*e)}%`)}))}preload(){this.load.image("cat","assets/common/cat.webp"),this.load.setPath("assets/games/emoji-match/"),this.load.image("background","background.png"),this.load.image("logo","logo.png"),this.load.atlas("emojis","emojis.png","emojis.json"),this.load.image("volume-icon","volume-icon.png"),this.load.image("volume-icon_off","volume-icon_off.png"),this.load.image("exit","exit.png"),this.load.setPath("assets/games/emoji-match/sounds/"),this.load.audio("card-mismatch","card-mismatch.mp3"),this.load.audio("music",["music.ogg","music.m4a","music.mp3"]),this.load.audio("countdown",["countdown.ogg","countdown.m4a","countdown.mp3"]),this.load.audio("match",["match.ogg","match.m4a","match.mp3"])}create(){this.sound.locked,this.scene.start("MainMenu")}}class y extends Phaser.Scene{constructor(){super("MainMenu"),t(this,"fontStyle",{fontFamily:"Arial",fontSize:34,color:"#ffffff",fontStyle:"bold",padding:16,align:"center",lineHeight:36}),t(this,"music"),t(this,"totalScoreText"),t(this,"totalScore",0),t(this,"maxScore",0),t(this,"kouFen",!1),t(this,"target",0)}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;let i=this.add.image(t/2,s/2,"dark").setScale(t/540,s/839).setInteractive();this.volumeButton(),this.tweens.add({targets:i,alpha:{from:0,to:1},duration:1e3}),this.add.text(t/2,s/2+200,"Selecting two identical expressions together\n can successfully eliminate them",{...this.fontStyle,fontSize:15,color:"#fff"}).setOrigin(.5,.5);const o=this.add.text(t/2,s/2+120,"Click to Play",{align:"center",strokeThickness:4,fontSize:32,fontStyle:"bold",color:"#000000"}).setOrigin(.5).setDepth(3);this.add.tween({targets:o,duration:800,ease:e=>e>.8,alpha:0,yoyo:!0,repeat:-1}),this.music||(this.music=this.sound.play("music",{loop:!0}));const a=localStorage.getItem("volume")||1;this.sound.setVolume(a);let n=this.add.image(t/2,0,"logo");this.tweens.add({targets:n,y:s/2-100,alpha:{from:0,to:1},ease:"bounce.out",duration:1200}),i.on(Phaser.Input.Events.POINTER_DOWN,(async()=>{this.scene.start("MainGame")})),f.emit("current-scene-ready",this)}closeButton(e){const t=this.add.image(e-25,30,"exit").setName("exit").setScale(.5,.5);t.setInteractive(),t.on(Phaser.Input.Events.POINTER_DOWN,(()=>{f.emit("exit",!0)}))}volumeButton(){const e=this.add.image(25,30,"volume-icon").setName("volume-icon");e.setInteractive(),e.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.input.setDefaultCursor("pointer")})),e.on(Phaser.Input.Events.POINTER_OUT,(()=>{console.log("Mouse leave"),this.input.setDefaultCursor("default")}));const t=localStorage.getItem("volume")||1;e.setTexture(1==t?"volume-icon":"volume-icon_off"),e.setAlpha(1==t?1:.5),e.on(Phaser.Input.Events.POINTER_DOWN,(()=>{0===this.sound.volume?(this.sound.setVolume(1),localStorage.setItem("volume","1"),e.setTexture("volume-icon"),e.setAlpha(1)):(localStorage.setItem("volume","0"),this.sound.setVolume(0),e.setTexture("volume-icon_off"),e.setAlpha(.5))}))}update(){this.kouFen&&(this.totalScore=this.totalScore-20,this.totalScore<this.target?(this.totalScoreText.setText(`Score: ${this.target}`),this.target-this.totalScore>500&&(this.scene.start("MainGame"),this.kouFen=!1)):this.totalScoreText.setText(`Score: ${this.totalScore}`))}showTotal(e){}}class S extends Phaser.Scene{constructor(){super("MainGame"),t(this,"emojis"),t(this,"circle1"),t(this,"circle2"),t(this,"child1"),t(this,"child2"),t(this,"selectedEmoji"),t(this,"matched"),t(this,"score"),t(this,"scoreText"),t(this,"timer"),t(this,"shakeTimer"),t(this,"timerText"),t(this,"width",0),t(this,"height",0),t(this,"totalScoreText"),t(this,"totalScore",0),t(this,"newTotalScore",0),t(this,"isStart",!1),t(this,"fontStyle",{fontFamily:"Arial",fontSize:22,color:"#ffffff",fontStyle:"bold",padding:16,shadow:{color:"#000000",fill:!0,offsetX:2,offsetY:2,blur:4}}),this.emojis,this.circle1,this.circle2,this.child1,this.child2,this.selectedEmoji=null,this.matched=!1,this.score=0,this.scoreText,this.timer,this.timerText,this.shakeTimer}init(){this.cameras.main.fadeIn(500)}closeButton(e){const t=this.add.image(e-25,30,"exit").setName("exit").setScale(.5,.5);t.setInteractive(),t.on(Phaser.Input.Events.POINTER_DOWN,(()=>{f.emit("exit",!0)}))}volumeButton(){const e=this.add.image(25,30,"volume-icon").setName("volume-icon");e.setInteractive(),e.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.input.setDefaultCursor("pointer")})),e.on(Phaser.Input.Events.POINTER_OUT,(()=>{console.log("Mouse leave"),this.input.setDefaultCursor("default")}));const t=localStorage.getItem("volume")||1;e.setTexture(1==t?"volume-icon":"volume-icon_off"),e.setAlpha(1==t?1:.5),console.log(t),e.on(Phaser.Input.Events.POINTER_DOWN,(()=>{0===this.sound.volume?(this.sound.setVolume(1),localStorage.setItem("volume","1"),e.setTexture("volume-icon"),e.setAlpha(1)):(localStorage.setItem("volume","0"),this.sound.setVolume(0),e.setTexture("volume-icon_off"),e.setAlpha(.5))}))}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;this.width=t,this.height=s,this.add.image(t/2,s/2,"dark").setScale(t/540,s/839).setInteractive,this.volumeButton(),this.circle1=this.add.circle(0,0,36).setStrokeStyle(3,16291342),this.circle2=this.add.circle(0,0,36).setStrokeStyle(3,65280),this.circle1.setVisible(!1),this.circle2.setVisible(!1),this.emojis=this.add.group({key:"emojis",frameQuantity:1,repeat:15,gridAlign:{width:4,height:4,cellWidth:90,cellHeight:90,x:t/2-170,y:s/2-170,position:0}}),this.timerText=this.add.text(50,70,"30:00",this.fontStyle).setOrigin(.5,.5),this.scoreText=this.add.text(t-30,70,`${this.score}`,{...this.fontStyle,color:"#ff0000"}).setOrigin(.5,.5),this.add.image(t-65,70,"cat").setScale(.04,.04).setDepth(1e3);let i=this.add.graphics();i.lineStyle(2,16777215),i.strokeRoundedRect(15,55,70,30,4),this.emojis.getChildren().forEach((e=>{e.setInteractive()})),this.input.on("gameobjectdown",this.selectEmoji,this),this.arrangeGrid(),f.emit("current-scene-ready",this)}start(e,t){t.type&&"volume-icon"==t.name||(this.score=0,this.matched=!1,this.timer=this.time.addEvent({delay:3e4,callback:this.gameOver,callbackScope:this}),this.sound.play("countdown",{delay:27}),this.isStart=!0)}shake(){this.cameras.main.shake(100,.01)}selectEmoji(e,t){this.isStart||this.start(e,t),t.type&&"volume-icon"==t.name||this.matched||(this.selectedEmoji?t!==this.selectedEmoji&&(t.frame.name===this.selectedEmoji.frame.name?(this.circle1.setStrokeStyle(3,65280),this.circle2.setPosition(t.x,t.y),this.circle2.setVisible(!0),this.tweens.add({targets:[this.child1,this.child2],scale:1.4,angle:"-=30",yoyo:!0,ease:"sine.inout",duration:200,completeDelay:200,onComplete:()=>this.newRound()}),this.sound.play("match")):(this.circle1.setPosition(t.x,t.y),this.circle1.setVisible(!0),this.selectedEmoji=t)):(this.circle1.setPosition(t.x,t.y),this.circle1.setVisible(!0),this.selectedEmoji=t))}newRound(){this.matched=!1,this.score++,this.scoreText.setText(200*this.score),this.circle1.setStrokeStyle(3,16291342),this.circle1.setVisible(!1),this.circle2.setVisible(!1),this.tweens.add({targets:this.emojis.getChildren(),scale:0,ease:"power2",duration:600,delay:this.tweens.stagger(100,{grid:[4,4],from:"center"}),onComplete:()=>this.arrangeGrid()})}arrangeGrid(){let e=Phaser.Utils.Array.NumberArray(1,40),t=Phaser.Utils.Array.NumberArray(0,15),s=this.emojis.getChildren();for(let a=0;a<16;a++){let t=Phaser.Utils.Array.RemoveRandomElement(e);s[a].setFrame("smile"+t)}let i=Phaser.Utils.Array.RemoveRandomElement(t),o=Phaser.Utils.Array.RemoveRandomElement(t);this.child1=s[i],this.child2=s[o],this.child2.setFrame(this.child1.frame.name),console.log("Pair: ",i,o),this.selectedEmoji=null,this.tweens.add({targets:s,scale:{start:0,from:0,to:1},ease:"bounce.out",duration:600,delay:this.tweens.stagger(100,{grid:[4,4],from:"center"})})}update(){if(this.timer)if(1===this.timer.getProgress())this.timerText.setText("00:00"),this.timer=null;else{const e=(30-this.timer.getElapsedSeconds()).toPrecision(4),t=e.indexOf(".");let s=e.substring(0,t),i=e.substr(t+1,2);s=Phaser.Utils.String.Pad(s,2,"0",1),this.timerText.setText(s+":"+i)}}async gameOver(){this.circle1.setStrokeStyle(4,16525734).setPosition(this.child1.x,this.child1.y).setVisible(!0),this.circle2.setStrokeStyle(4,16525734).setPosition(this.child2.x,this.child2.y).setVisible(!0),this.time.removeAllEvents(),this.timer=null,setTimeout((()=>{let e=200*this.score;localStorage.setItem("currentScore",`${e}`),this.scene.start("GameOver")}),1e3)}}const j={type:h.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#222",scene:[p,x,y,S,v]},T=s.forwardRef((function({currentActiveScene:e,size:t},n){const r=s.useRef(null);a.getInstance();const c=i();return s.useLayoutEffect((()=>(null===r.current&&(r.current=(()=>{const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;return new h.Game({...j,parent:"game-container",width:t,height:s})})(),"function"==typeof n?n({game:r.current,scene:null}):n&&(n.current={game:r.current,scene:null})),()=>{r.current&&(r.current.destroy(!0),null!==r.current&&(r.current=null))})),[n]),s.useEffect((()=>(f.on("current-scene-ready",(t=>{e&&"function"==typeof e&&e(t),"function"==typeof n?n({game:r.current,scene:t}):n&&(n.current={game:r.current,scene:t})})),f.on("exit",(e=>{c("-1")})),()=>{f.removeListener("current-scene-ready"),f.removeListener("exit")})),[e,n]),o.jsx("div",{id:"game-container"})}));function b(){var e;const t=s.useRef(null),h=n((e=>e.user.info)),[p,f]=s.useState("Preloader"),[v,x]=s.useState(0),y=`https://t.me/HamstersTon_bot/Hamster?startapp=${btoa(h.user_id)}`,[S,j]=s.useState(!1),b=r(),k=i(),w=c(),I=a.getInstance(),[E,N]=s.useState(!1),P=n((e=>e.user.system)),R=()=>{const e=y,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),g.show({content:"copied",position:"top"})},O=()=>{const e=`I scored ${v} points in Cat Game!\nI dare you to challenge me!\nFarm $HMSTR with me and secure your token allocation through Tomarket.ai.\nUse my link to get 2,000 $HMSTR!`;b.shareURL(y,e)};return s.useEffect((()=>{(()=>{if(t.current){const e=t.current.scene;e&&"MainMenu"==p&&e.showTotal(h)}})()}),[null==(e=t.current)?void 0:e.scene]),o.jsxs("div",{className:"game-wrapper",children:["GameOver"==p?o.jsxs("div",{className:"game-over",children:[o.jsxs("div",{className:"game-over-top",children:[o.jsx("img",{src:"/assets/game/reward.png",alt:"gif",className:"congrats-img"}),o.jsx("div",{className:"congrats",children:"Congrats!"}),o.jsx("div",{className:"congrats",children:"bountiful harvest"}),o.jsxs("div",{className:"score-wrapper",children:[o.jsx("span",{children:"+"}),o.jsxs("span",{children:[v," "]}),o.jsx("img",{src:"/assets/common/cat.webp",alt:"tomato"})]})]}),o.jsxs("div",{className:"game-over-bots",children:[o.jsx("div",{className:"game-over-btn",onClick:()=>{j(!0)},children:"Share Your Results +500"}),o.jsx("div",{className:"game-over-btn play-btn",onClick:()=>{0!=h.ticket?f("Preloader"):N(!0)},children:o.jsxs("div",{className:"game-over-bot-middle",children:["Play (",h.ticket," Attempts Left)"]})})]})]}):o.jsx(T,{ref:t,currentActiveScene:async e=>{if(f(e.scene.key),"GameOver"==e.scene.key){I.emit("showCongrates",{time:2e3,visible:!0});const e=localStorage.getItem("currentScore")||0;parseInt(e)&&(I.emit("showCongrates",{time:1e3,visible:!0}),x(e),m({score:1*e}).then((e=>{0==e.code&&w(l(e.data))})).catch((e=>{console.error(e)})))}if("MainGame"==e.scene.key){const e=await u();0!=e.code?k(-1):w(l(e.data))}}}),o.jsx(d,{visible:S,onMaskClick:()=>{j(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:o.jsxs("div",{className:"popup-result",children:[o.jsxs("div",{className:"popup-title",children:["Share Results",o.jsx("svg",{onClick:()=>j(!1),className:"close-svg",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5777",width:"16",height:"16",children:o.jsx("path",{d:"M597.795527 511.488347 813.564755 295.718095c23.833825-23.833825 23.833825-62.47489 0.001023-86.307691-23.832801-23.832801-62.47489-23.833825-86.307691 0L511.487835 425.180656 295.717583 209.410404c-23.833825-23.833825-62.475913-23.833825-86.307691 0-23.832801 23.832801-23.833825 62.47489 0 86.308715l215.769228 215.769228L209.410915 727.258599c-23.833825 23.833825-23.833825 62.47489 0 86.307691 23.832801 23.833825 62.473867 23.833825 86.307691 0l215.768205-215.768205 215.769228 215.769228c23.834848 23.833825 62.475913 23.832801 86.308715 0 23.833825-23.833825 23.833825-62.47489 0-86.307691L597.795527 511.488347z",fill:"#272636","p-id":"5778"})})]}),o.jsxs("div",{className:"popup-content",children:[o.jsx("div",{className:"popup-content-jb",children:"🏆"}),o.jsxs("div",{className:"score-wrapper",children:[o.jsx("span",{children:"+"}),o.jsxs("span",{children:[v," "]}),"$HMSTR"]}),o.jsxs("div",{children:["I scored ",v," points in Hamster Game!"]}),o.jsx("div",{children:"I dare you to challenge me!"}),o.jsx("div",{className:"popup-content-btn",onClick:()=>R(),children:"Copy link"}),o.jsx("div",{className:"popup-content-btn btn-send",onClick:()=>O(),children:"Send"})]})]})}),o.jsx(d,{visible:E,onMaskClick:()=>{N(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},className:"popup-invite",children:o.jsxs("div",{className:"popup-frens",children:[o.jsxs("div",{className:"title",children:["Invite a Fren",o.jsx("svg",{onClick:()=>N(!1),className:"close-svg",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5777",width:"18",height:"18",children:o.jsx("path",{d:"M597.795527 511.488347 813.564755 295.718095c23.833825-23.833825 23.833825-62.47489 0.001023-86.307691-23.832801-23.832801-62.47489-23.833825-86.307691 0L511.487835 425.180656 295.717583 209.410404c-23.833825-23.833825-62.475913-23.833825-86.307691 0-23.832801 23.832801-23.833825 62.47489 0 86.308715l215.769228 215.769228L209.410915 727.258599c-23.833825 23.833825-23.833825 62.47489 0 86.307691 23.832801 23.833825 62.473867 23.833825 86.307691 0l215.768205-215.768205 215.769228 215.769228c23.834848 23.833825 62.475913 23.832801 86.308715 0 23.833825-23.833825 23.833825-62.47489 0-86.307691L597.795527 511.488347z",fill:"#272636","p-id":"5778"})})]}),o.jsxs("div",{className:"content",children:[o.jsxs("div",{className:"content-desc",children:[o.jsxs("div",{children:["Get ",null==P?void 0:P.invite_add," $HMSTR and ",null==P?void 0:P.ticket," ticket（Invite a Friend）"]}),o.jsxs("div",{children:["Get ",null==P?void 0:P.huiYuan_add," $HMSTR and ",null==P?void 0:P.huiYuan_ticket," tickets（Invite a Telegram Premium）"]})]}),o.jsx("div",{className:"popup-content-btn",onClick:()=>R(),children:"Copy link"}),o.jsx("div",{className:"popup-content-btn btn-send",onClick:()=>O(),children:"Send"})]})]})})]})}export{b as default};
