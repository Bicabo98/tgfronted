var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,u as a,j as i,E as o,d as n,m as r,b as c,s as d}from"./index-sT5wyuMN.js";import{p as l}from"./phaser-BsKGbp7r.js";import{P as h}from"./popup-BNETPUH7.js";import{e as u,b as m,T as g}from"./game-CxZlzPMw.js";import"./with-default-props-YTkVgPz6.js";import"./get-scroll-parent-CbYlqSdh.js";class p extends l.Scene{constructor(){super("Boot")}preload(){this.load.setPath("assets/games/card-memory-game/"),this.load.image("dark","bg.png")}create(){this.scene.start("Preloader")}}const f=new l.Events.EventEmitter;class v extends l.Scene{constructor(){super("GameOver"),t(this,"camera"),t(this,"background"),t(this,"gameOverText"),t(this,"scoreText"),t(this,"totalScore",0)}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;let a=this.add.image(t/2,s/2,"background");this.tweens.add({targets:a,alpha:{from:0,to:1},duration:1e3});const i={fontFamily:"Arial",fontSize:32,color:"#ffffff",fontStyle:"bold",padding:16,shadow:{color:"#000000",fill:!0,offsetX:2,offsetY:2,blur:4}},o=this.add.text(t/2,0,"Game Over",{fontFamily:"Arial Black",fontSize:50,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5,.5).setDepth(100);this.tweens.add({targets:o,y:s/2,ease:"bounce.out"});const n=this.add.text(t/2,s/2-200,`Found: ${this.registry.get("found")?this.registry.get("found"):0}`,i).setOrigin(.5,.5);this.tweens.add({targets:n,alpha:{from:0,to:1},scale:{from:.5,to:1},duration:1e3}),this.totalScore=this.registry.get("totalScore");const r=localStorage.getItem("maxFound")||0;this.registry.get("found")&&this.registry.get("found")>r&&localStorage.setItem("maxFound",this.registry.get("found")),this.scoreText=this.add.text(t/2,s/2-150,`Score: ${this.registry.get("totalScore")?this.registry.get("totalScore"):0}`,i).setOrigin(.5,.5),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")})),f.emit("current-scene-ready",this)}changeScene(){this.scene.start("MainMenu")}update(){var e,t;this.registry.get("found")&&(this.totalScore=this.totalScore+2,this.totalScore-this.registry.get("totalScore")>600*this.registry.get("found")?null==(e=this.scoreText)||e.setText("Score:"+(this.registry.get("totalScore")-600*this.registry.get("found"))):null==(t=this.scoreText)||t.setText(`Score:${this.totalScore}`))}}class y extends l.Scene{constructor(){super("Preloader"),t(this,"loadText")}init(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;this.add.image(t/2,s/2,"dark").setScale(t/600,s/900);const a=Math.max(t/2,280);this.add.rectangle(t/2,s/2,a,19).setStrokeStyle(1,16777215);const i=this.add.rectangle(t/2-a/2+5,s/2,4,14,16777215);this.loadText=this.add.text(t/2,s/2-40,"0%",{fontFamily:"Arial",fontSize:24,color:"#e3f2ed"}).setOrigin(.5,.5),this.load.on("progress",(e=>{i.width=a*e-5,this.loadText.setText(`${Math.floor(100*e)}%`)}))}preload(){this.load.image("cat","assets/common/cat.webp"),this.load.setPath("assets/games/card-memory-game/"),this.load.image("volume-icon","ui/volume-icon.png"),this.load.image("volume-icon_off","ui/volume-icon_off.png"),this.load.audio("theme-song","audio/fat-caps-audionatix.mp3"),this.load.audio("whoosh","audio/whoosh.mp3"),this.load.audio("card-flip","audio/card-flip.mp3"),this.load.audio("card-match","audio/card-match.mp3"),this.load.audio("card-mismatch","audio/card-mismatch.mp3"),this.load.audio("card-slide","audio/card-slide.mp3"),this.load.audio("victory","audio/victory.mp3"),this.load.image("background"),this.load.image("card-back","cards/card-back.png"),this.load.image("card-0","cards/card-0.png"),this.load.image("card-1","cards/card-1.png"),this.load.image("card-2","cards/card-2.png"),this.load.image("card-3","cards/card-3.png"),this.load.image("card-4","cards/card-4.png"),this.load.image("card-5","cards/card-5.png"),this.load.image("heart","ui/heart.png")}create(){this.sound.locked,this.scene.start("MainMenu")}}class x extends Phaser.Scene{constructor(){super("MainMenu"),t(this,"fontStyle",{fontFamily:"Arial",fontSize:34,color:"#ffffff",fontStyle:"bold",padding:16,align:"center",lineHeight:36})}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;let a=this.add.image(t/2,s/2,"dark").setScale(t/600,s/900).setInteractive();this.tweens.add({targets:a,alpha:{from:0,to:1},duration:1e3}),this.volumeButton();const i=localStorage.getItem("volume")||1;this.sound.setVolume(i),this.add.text(t/2,s/2+200,"Selecting two identical expressions together\n can successfully eliminate them",{...this.fontStyle,fontSize:15,color:"#fff"}).setOrigin(.5,.5);const o=this.add.text(this.sys.game.scale.width/2,this.sys.game.scale.height/2-100,"Memory Card Game\nClick to Play",{align:"center",strokeThickness:4,fontSize:32,fontStyle:"bold",color:"#8c7ae6"}).setOrigin(.5).setDepth(3).setInteractive();this.add.tween({targets:o,duration:800,ease:e=>e>.8,alpha:0,repeat:-1,yoyo:!0}),o.on(Phaser.Input.Events.POINTER_OVER,(()=>{o.setColor("#9c88ff"),this.input.setDefaultCursor("pointer")})),o.on(Phaser.Input.Events.POINTER_OUT,(()=>{o.setColor("#8c7ae6"),this.input.setDefaultCursor("default")})),o.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.sound.play("whoosh",{volume:1.3}),this.add.tween({targets:o,ease:Phaser.Math.Easing.Bounce.InOut,y:-1e3,onComplete:()=>{this.sound.get("theme-song")||this.sound.play("theme-song",{loop:!0,volume:.5}),this.scene.start("MainGame")}})})),a.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.sound.play("whoosh",{volume:1.3}),this.add.tween({targets:o,ease:Phaser.Math.Easing.Bounce.InOut,y:-1e3,onComplete:()=>{this.sound.get("theme-song")||this.sound.play("theme-song",{loop:!0,volume:.5}),this.scene.start("MainGame")}})})),f.emit("current-scene-ready",this)}volumeButton(){const e=this.add.image(25,30,"volume-icon").setName("volume-icon");e.setInteractive(),e.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.input.setDefaultCursor("pointer")})),e.on(Phaser.Input.Events.POINTER_OUT,(()=>{console.log("Mouse leave"),this.input.setDefaultCursor("default")}));const t=localStorage.getItem("volume")||1;e.setTexture(1==t?"volume-icon":"volume-icon_off"),e.setAlpha(1==t?1:.5),e.on(Phaser.Input.Events.POINTER_DOWN,(()=>{0===this.sound.volume?(this.sound.setVolume(1),localStorage.setItem("volume","1"),e.setTexture("volume-icon"),e.setAlpha(1)):(localStorage.setItem("volume","0"),this.sound.setVolume(0),e.setTexture("volume-icon_off"),e.setAlpha(.5))}))}}class O extends Phaser.Scene{constructor(){super("MainGame"),t(this,"cardNames"),t(this,"cards"),t(this,"cardOpened"),t(this,"canMove"),t(this,"lives"),t(this,"gridConfiguration"),t(this,"scoreText"),t(this,"width"),t(this,"height"),t(this,"score"),t(this,"fontStyle",{fontFamily:"Arial",fontSize:22,color:"#ffffff",fontStyle:"bold",padding:16,shadow:{color:"#000000",fill:!0,offsetX:2,offsetY:2,blur:4}}),this.cardNames=["card-0","card-1","card-2","card-3","card-4","card-5"],this.cards=[],this.cardOpened=void 0,this.canMove=!1,this.lives=0,this.scoreText="",this.score=0}init(){this.lives=7,this.score=0,this.volumeButton()}create(){const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;this.width=t,this.height=s,this.add.image(t/2,s/2,"dark").setScale(t/600,s/900).setInteractive,this.gridConfiguration={x:84,y:186,paddingX:6,paddingY:6},this.startGame(),this.scoreText=this.add.text(t-30,30,`${this.score}`,{...this.fontStyle,color:"#ff0000"}).setOrigin(.5,.5),this.add.image(t-65,30,"cat").setScale(.04,.04).setDepth(1e3),f.emit("current-scene-ready",this)}restartGame(){this.cardOpened=void 0,this.cameras.main.fadeOut(200*this.cards.length),this.cards.reverse().map(((e,t)=>{this.add.tween({targets:e.gameObject,duration:500,y:1e3,delay:100*t,onComplete:()=>{e.gameObject.destroy()}})})),this.time.addEvent({delay:200*this.cards.length,callback:()=>{this.cards=[],this.canMove=!1,this.scene.restart(),this.sound.play("card-slide",{volume:1.2})}})}createGridCards(){return Phaser.Utils.Array.Shuffle([...this.cardNames,...this.cardNames]).map(((e,t)=>{const s=(({scene:e,x:t,y:s,frontTexture:a,cardName:i})=>{let o=!1;const n={y:0},r="card-back",c=e.add.plane(t,s,r).setName(i).setInteractive();return c.modelRotationY=180,{gameObject:c,flip:t=>{o||e.add.tween({targets:[n],y:180===n.y?0:180,ease:Phaser.Math.Easing.Expo.Out,duration:500,onStart:()=>{o=!0,e.sound.play("card-flip"),e.tweens.chain({targets:c,ease:Phaser.Math.Easing.Expo.InOut,tweens:[{duration:200,scale:1.1},{duration:300,scale:1}]})},onUpdate:()=>{c.rotateY=180+n.y;const e=Math.floor(c.rotateY)%360;e>=0&&e<=90||e>=270&&e<=359?c.setTexture(a):c.setTexture(r)},onComplete:()=>{o=!1,t&&t()}})},destroy:()=>{e.add.tween({targets:[c],y:c.y-1e3,easing:Phaser.Math.Easing.Elastic.In,duration:500,onComplete:()=>{c.destroy()}})},cardName:i}})({scene:this,x:(this.gridConfiguration.x+this.gridConfiguration.paddingX)*(t%4)+(this.width-336+3*this.gridConfiguration.paddingX)/2+24,y:-1e3,frontTexture:e,cardName:e});return this.add.tween({targets:s.gameObject,duration:800,delay:100*t,onStart:()=>this.sound.play("card-slide",{volume:1.2}),y:this.gridConfiguration.y+(115+this.gridConfiguration.paddingY)*Math.floor(t/4)}),s}))}createHearts(){return Array.from(new Array(this.lives)).map(((e,t)=>{const s=this.add.image(this.sys.game.scale.width+1e3,85,"heart").setScale(1.5);return this.add.tween({targets:s,ease:Phaser.Math.Easing.Expo.InOut,duration:1e3,delay:1e3+200*t,x:60+30*t}),s}))}volumeButton(){const e=this.add.image(25,30,"volume-icon").setName("volume-icon").setDepth(5);e.setInteractive(),e.on(Phaser.Input.Events.POINTER_OVER,(()=>{this.input.setDefaultCursor("pointer")})),e.on(Phaser.Input.Events.POINTER_OUT,(()=>{console.log("Mouse leave"),this.input.setDefaultCursor("default")}));const t=localStorage.getItem("volume")||1;e.setTexture(1==t?"volume-icon":"volume-icon_off"),e.setAlpha(1==t?1:.5),e.on(Phaser.Input.Events.POINTER_DOWN,(()=>{0===this.sound.volume?(this.sound.setVolume(1),localStorage.setItem("volume","1"),e.setTexture("volume-icon"),e.setAlpha(1)):(localStorage.setItem("volume","0"),this.sound.setVolume(0),e.setTexture("volume-icon_off"),e.setAlpha(.5))}))}startGame(){const e=this.add.text(this.sys.game.scale.width/2,-1e3,"YOU WIN",{align:"center",strokeThickness:4,fontSize:40,fontStyle:"bold",color:"#8c7ae6"}).setOrigin(.5).setDepth(3).setInteractive(),t=this.add.text(this.sys.game.scale.width/2,-1e3,"GAME OVER\nClick to restart",{align:"center",strokeThickness:4,fontSize:40,fontStyle:"bold",color:"#ff0000"}).setName("gameOverText").setDepth(3).setOrigin(.5).setInteractive(),s=this.createHearts();this.cards=this.createGridCards(),this.time.addEvent({delay:200*this.cards.length,callback:()=>{this.canMove=!0}}),this.input.on(Phaser.Input.Events.POINTER_MOVE,(e=>{this.canMove&&(this.cards.find((t=>t.gameObject.hasFaceAt(e.x,e.y)))?this.input.setDefaultCursor("pointer"):this.input.setDefaultCursor("default"))})),this.input.on(Phaser.Input.Events.POINTER_DOWN,(e=>{if(this.canMove&&this.cards.length){const t=this.cards.find((t=>t.gameObject.hasFaceAt(e.x,e.y)));if(t)if(this.canMove=!1,void 0!==this.cardOpened){if(this.cardOpened.gameObject.x===t.gameObject.x&&this.cardOpened.gameObject.y===t.gameObject.y)return this.canMove=!0,!1;t.flip((()=>{if(this.cardOpened.cardName===t.cardName)this.sound.play("card-match"),this.cardOpened.destroy(),t.destroy(),this.cards=this.cards.filter((e=>e.cardName!==t.cardName)),this.cardOpened=void 0,this.canMove=!0,this.score+=100,this.scoreText.setText(this.score);else{this.sound.play("card-mismatch"),this.cameras.main.shake(400,.005);const e=s[s.length-1];this.add.tween({targets:e,ease:Phaser.Math.Easing.Expo.InOut,duration:1e3,y:-1e3,onComplete:()=>{e.destroy(),s.pop()}}),this.lives-=1,t.flip(),this.cardOpened.flip((()=>{this.cardOpened=void 0,this.canMove=!0}))}if(0===this.lives)return this.sound.play("whoosh",{volume:1.3}),void this.gameOver("fail");0===this.cards.length&&(this.sound.play("whoosh",{volume:1.3}),this.sound.play("victory"),this.score+=500,this.scoreText.setText(this.score),this.gameOver("win"),this.canMove=!1)}))}else void 0===this.cardOpened&&this.lives>0&&this.cards.length>0&&(t.flip((()=>{this.canMove=!0})),this.cardOpened=t)}})),e.on(Phaser.Input.Events.POINTER_OVER,(()=>{e.setColor("#FF7F50"),this.input.setDefaultCursor("pointer")})),e.on(Phaser.Input.Events.POINTER_OUT,(()=>{e.setColor("#8c7ae6"),this.input.setDefaultCursor("default")})),e.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.sound.play("whoosh",{volume:1.3}),this.add.tween({targets:e,ease:Phaser.Math.Easing.Bounce.InOut,y:-1e3,onComplete:()=>{this.restartGame()}})})),t.on(Phaser.Input.Events.POINTER_OVER,(()=>{t.setColor("#FF7F50"),this.input.setDefaultCursor("pointer")})),t.on(Phaser.Input.Events.POINTER_OUT,(()=>{t.setColor("#8c7ae6"),this.input.setDefaultCursor("default")})),t.on(Phaser.Input.Events.POINTER_DOWN,(()=>{this.add.tween({targets:t,ease:Phaser.Math.Easing.Bounce.InOut,y:-1e3,onComplete:()=>{this.restartGame()}})}))}async gameOver(e){this.time.removeAllEvents(),setTimeout((()=>{let t=this.score;localStorage.setItem("currentScore",`${t}`),localStorage.setItem("result",`${e||"fail"}`),this.scene.start("GameOver")}),1e3)}}const S={type:l.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#222",scene:[p,y,x,O,v]},I=s.forwardRef((function({currentActiveScene:e,size:t},n){const r=s.useRef(null);o.getInstance();const c=a();return s.useLayoutEffect((()=>(null===r.current&&(r.current=(()=>{const e=document.getElementById("root"),t=e.clientWidth,s=e.clientHeight;return new l.Game({...S,parent:"game-container",width:t,height:s})})(),"function"==typeof n?n({game:r.current,scene:null}):n&&(n.current={game:r.current,scene:null})),()=>{r.current&&(r.current.destroy(!0),null!==r.current&&(r.current=null))})),[n]),s.useEffect((()=>(f.on("current-scene-ready",(t=>{e&&"function"==typeof e&&e(t),"function"==typeof n?n({game:r.current,scene:t}):n&&(n.current={game:r.current,scene:t})})),f.on("exit",(e=>{c("-1")})),()=>{f.removeListener("current-scene-ready"),f.removeListener("exit")})),[e,n]),i.jsx("div",{id:"game-container"})}));function E(){const e=s.useRef(null),t=n((e=>e.user.info)),[l,p]=s.useState("Preloader"),[f,v]=s.useState(0),[y,x]=s.useState("fail"),O=`https://t.me/HamstersTon_bot/Hamster?startapp=${btoa(t.user_id)}`,[S,E]=s.useState(!1),w=r(),T=a(),N=c(),b=o.getInstance(),[j,C]=s.useState(!1),P=n((e=>e.user.system)),k=()=>{const e=O,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),g.show({content:"copied",position:"top"})},M=()=>{const e=`I scored ${f} points in Cat Game!\nI dare you to challenge me!\nFarm $HMSTR with me and secure your token allocation through Tomarket.ai.\nUse my link to get 2,000 $HMSTR!`;w.shareURL(O,e)};return i.jsxs("div",{className:"game-wrapper",children:["GameOver"==l?i.jsxs("div",{className:"game-over",children:[i.jsxs("div",{className:"game-over-top",children:[i.jsx("img",{src:"/assets/game/reward.png",alt:"gif",className:"congrats-img"}),i.jsx("div",{className:"congrats",children:"Congrats!"}),i.jsx("div",{className:"congrats",children:"bountiful harvest"}),i.jsxs("div",{className:"score-wrapper",children:[i.jsx("span",{children:"+"}),i.jsxs("span",{children:[f," "]}),i.jsx("img",{src:"/assets/common/cat.webp",alt:"tomato"})]}),"win"==y?i.jsxs("div",{className:"score-wrapper",children:[i.jsx("span",{children:"+"}),i.jsxs("span",{children:[1," "]}),i.jsx("img",{src:"/assets/common/ticket.png",alt:"tomato"})]}):null]}),i.jsxs("div",{className:"game-over-bots",children:[i.jsx("div",{className:"game-over-btn",onClick:()=>{E(!0)},children:"Share Your Results +500"}),i.jsx("div",{className:"game-over-btn play-btn",onClick:()=>{0!=t.ticket?p("MainGame"):C(!0)},children:i.jsx("div",{className:"game-over-bot-middle",children:"win"==y?"Continue":`Play (${t.ticket} Attempts Left)`})})]})]}):i.jsx(I,{ref:e,currentActiveScene:async e=>{if(p(e.scene.key),"GameOver"==e.scene.key){b.emit("showCongrates",{time:2e3,visible:!0});const e=localStorage.getItem("currentScore")||0,t=localStorage.getItem("result");x(t),parseInt(e)&&(b.emit("showCongrates",{time:1e3,visible:!0}),v(e),u({score:1*e,result:t}).then((e=>{0==e.code&&N(d(e.data))})).catch((e=>{console.error(e)})))}if("MainGame"==e.scene.key){const e=await m();0!=e.code?T(-1):N(d(e.data))}}}),i.jsx(h,{visible:S,onMaskClick:()=>{E(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},children:i.jsxs("div",{className:"popup-result",children:[i.jsxs("div",{className:"popup-title",children:["Share Results",i.jsx("svg",{onClick:()=>E(!1),className:"close-svg",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5777",width:"16",height:"16",children:i.jsx("path",{d:"M597.795527 511.488347 813.564755 295.718095c23.833825-23.833825 23.833825-62.47489 0.001023-86.307691-23.832801-23.832801-62.47489-23.833825-86.307691 0L511.487835 425.180656 295.717583 209.410404c-23.833825-23.833825-62.475913-23.833825-86.307691 0-23.832801 23.832801-23.833825 62.47489 0 86.308715l215.769228 215.769228L209.410915 727.258599c-23.833825 23.833825-23.833825 62.47489 0 86.307691 23.832801 23.833825 62.473867 23.833825 86.307691 0l215.768205-215.768205 215.769228 215.769228c23.834848 23.833825 62.475913 23.832801 86.308715 0 23.833825-23.833825 23.833825-62.47489 0-86.307691L597.795527 511.488347z",fill:"#272636","p-id":"5778"})})]}),i.jsxs("div",{className:"popup-content",children:[i.jsx("div",{className:"popup-content-jb",children:"🏆"}),i.jsxs("div",{className:"score-wrapper",children:[i.jsx("span",{children:"+"}),i.jsxs("span",{children:[f," "]}),"$HMSTR"]}),i.jsxs("div",{children:["I scored ",f," points in Hamster Game!"]}),i.jsx("div",{children:"I dare you to challenge me!"}),i.jsx("div",{className:"popup-content-btn",onClick:()=>k(),children:"Copy link"}),i.jsx("div",{className:"popup-content-btn btn-send",onClick:()=>M(),children:"Send"})]})]})}),i.jsx(h,{visible:j,onMaskClick:()=>{C(!1)},bodyStyle:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},className:"popup-invite",children:i.jsxs("div",{className:"popup-frens",children:[i.jsxs("div",{className:"title",children:["Invite a Fren",i.jsx("svg",{onClick:()=>C(!1),className:"close-svg",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5777",width:"18",height:"18",children:i.jsx("path",{d:"M597.795527 511.488347 813.564755 295.718095c23.833825-23.833825 23.833825-62.47489 0.001023-86.307691-23.832801-23.832801-62.47489-23.833825-86.307691 0L511.487835 425.180656 295.717583 209.410404c-23.833825-23.833825-62.475913-23.833825-86.307691 0-23.832801 23.832801-23.833825 62.47489 0 86.308715l215.769228 215.769228L209.410915 727.258599c-23.833825 23.833825-23.833825 62.47489 0 86.307691 23.832801 23.833825 62.473867 23.833825 86.307691 0l215.768205-215.768205 215.769228 215.769228c23.834848 23.833825 62.475913 23.832801 86.308715 0 23.833825-23.833825 23.833825-62.47489 0-86.307691L597.795527 511.488347z",fill:"#272636","p-id":"5778"})})]}),i.jsxs("div",{className:"content",children:[i.jsxs("div",{className:"content-desc",children:[i.jsxs("div",{children:["Get ",null==P?void 0:P.invite_add," $HMSTR and ",null==P?void 0:P.ticket," ticket（Invite a Friend）"]}),i.jsxs("div",{children:["Get ",null==P?void 0:P.huiYuan_add," $HMSTR and ",null==P?void 0:P.huiYuan_ticket," tickets（Invite a Telegram Premium）"]})]}),i.jsx("div",{className:"popup-content-btn",onClick:()=>k(),children:"Copy link"}),i.jsx("div",{className:"popup-content-btn btn-send",onClick:()=>M(),children:"Send"})]})]})})]})}export{E as default};
